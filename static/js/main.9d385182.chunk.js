(this["webpackJsonpsimple-react-chat"]=this["webpackJsonpsimple-react-chat"]||[]).push([[0],{28:function(e,t,s){},36:function(e,t,s){"use strict";s.r(t),s.d(t,"Context",(function(){return y}));var a=s(3),n=s.n(a),r=s(21),c=s.n(r),i=(s(28),s(11)),u=s.n(i),o=s(13),l=s(12),d=s(10),m=s(22),j=s(16),b=s(4),f=function(e){var t=e.isLoading,s=e.onLogin;return Object(b.jsx)("div",{className:"log-in",children:Object(b.jsx)("button",{disabled:t,onClick:s,className:"log-in__button",children:t?"\u0412\u0425\u041e\u0414...":"\u0412\u043e\u0439\u0442\u0438 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e Google"})})},h=s(17),p=s(23),O=s.n(p),g=function(e){var t=e.text,s=e.userName,a=e.date;return Object(b.jsxs)("div",{className:"message",children:[Object(b.jsx)("p",{className:"message__text",children:t}),Object(b.jsxs)("div",{className:"message__user-container",children:[Object(b.jsx)("span",{className:"message__user-name",children:s}),Object(b.jsx)("span",{className:"message__user-name message__user-name--small",children:O()(a).toNow()})]})]})},x=function(e){var t=e.messageValue,s=e.setMessageValue,a=e.onSendMessage;return Object(b.jsxs)("form",{className:"form",children:[Object(b.jsx)("input",{value:t,onChange:function(e){return s(e.target.value)},className:"form__control",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"}),Object(b.jsx)("button",{onClick:a,type:"button",className:"form__button",id:"sent-button",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})},v=function(e){var t=e.messages,s=e.userName,r=e.onAddMessage,c=n.a.useState(""),i=Object(l.a)(c,2),u=i[0],o=i[1],d=n.a.useRef(null);return n.a.useEffect((function(){d.current.scrollTo(0,d.current.scrollHeight)}),[t]),Object(b.jsx)("div",{className:"chat-window",children:Object(b.jsxs)("div",{className:"chat-window__messages",children:[Object(b.jsx)("div",{ref:d,className:"chat-window__messages-wrapper",children:t&&t.map((function(e,t){return Object(a.createElement)(g,Object(h.a)(Object(h.a)({},e),{},{key:t}))}))}),Object(b.jsx)(x,{messageValue:u,setMessageValue:o,onSendMessage:function(){r({userName:s,text:u}),o("")}})]})})},N=function(e){var t=e.users,s=e.onLogOut;return Object(b.jsxs)("div",{className:"users-sidebar",children:[Object(b.jsxs)("h3",{children:["\u0412\u0441\u0435\u0433\u043e (",t.length,"):"]}),Object(b.jsx)("ul",{className:"users-sidebar__list",children:t.map((function(e,t){return Object(b.jsx)("li",{className:"users-sidebar__item",children:e},e+String(t))}))}),Object(b.jsx)("button",{className:"users-sidebar__log-out",onClick:s,children:"\u0412\u044b\u0439\u0442\u0438"})]})};var _=function(){var e=n.a.useContext(y),t=e.auth,s=e.firestore,a=Object(m.a)(t),r=Object(l.a)(a,3),c=r[0],i=r[1],h=r[2],p=Object(j.a)(s.collection("messages").orderBy("date")),O=Object(l.a)(p,3),g=O[0],x=O[1],_=O[2],w=Object(j.a)(s.collection("users").orderBy("uid")),k=Object(l.a)(w,3),S=k[0],C=k[1],L=k[2],I=function(){var e=Object(o.a)(u.a.mark((function e(){var a,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new d.a.auth.GoogleAuthProvider,e.next=3,t.signInWithPopup(a);case 3:if(n=e.sent,r=n.user,!S){e.next=9;break}if(S.find((function(e){var t=e.uid;return r.uid===t}))){e.next=9;break}return e.next=9,s.collection("users").add({uid:r.uid,userName:r.displayName});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(o.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.signOut();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(o.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.userName,n=t.text,e.next=3,s.collection("messages").add({userName:a,text:n,date:d.a.firestore.FieldValue.serverTimestamp()});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(h)return Object(b.jsx)("div",{children:JSON.stringify(h)});if(_)return Object(b.jsx)("div",{children:JSON.stringify(h)});if(L)return Object(b.jsx)("div",{children:JSON.stringify(h)});var A=g?g.map((function(e){var t=e.userName,s=e.text,a=e.date;return{userName:t,text:s,date:a&&a.toDate()}})):[];return Object(b.jsx)("div",{className:"wrapper",children:c&&g&&S?Object(b.jsxs)("div",{className:"chat",children:[Object(b.jsx)(v,{messages:A,userName:c.displayName,onAddMessage:B}),Object(b.jsx)(N,{onLogOut:M,users:(null===S||void 0===S?void 0:S.map((function(e){return e.userName})))||[]})]}):Object(b.jsx)(f,{isLoading:i||x||C,onLogin:I})})},w=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,37)).then((function(t){var s=t.getCLS,a=t.getFID,n=t.getFCP,r=t.getLCP,c=t.getTTFB;s(e),a(e),n(e),r(e),c(e)}))};s(34),s(35);d.a.initializeApp({apiKey:"AIzaSyAIyPyky-SUBZFnsOO5xcL7Ym0zOeqRZYg",authDomain:"react-simple-chat-e20d8.firebaseapp.com",databaseURL:"https://react-simple-chat-e20d8-default-rtdb.firebaseio.com",projectId:"react-simple-chat-e20d8",storageBucket:"react-simple-chat-e20d8.appspot.com",messagingSenderId:"427434539112",appId:"1:427434539112:web:957e56e253ac220dd2e3dd",measurementId:"G-M74BJ46886"});var y=Object(a.createContext)(null),k=d.a.auth(),S=d.a.firestore();c.a.render(Object(b.jsx)(n.a.StrictMode,{children:Object(b.jsx)(y.Provider,{value:{firebase:d.a,auth:k,firestore:S},children:Object(b.jsx)(_,{})})}),document.getElementById("root")),w()}},[[36,1,2]]]);
//# sourceMappingURL=main.9d385182.chunk.js.map